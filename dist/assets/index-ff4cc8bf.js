import{q as S,c as h,o as k,b as v,a as m,d as u,e as E,f as j,h as g,u as f,w as H,j as I}from"./firebase-141d664e.js";import{d as n}from"./index-12e734f0.js";function G(t){try{const e=S(h(n,"waitlist"),k("joined_at","desc"));return v(e,a=>{const s=a.docs.map(o=>{var i,d,l;return{id:o.id,...o.data(),joined_at:((l=(d=(i=o.data().joined_at)==null?void 0:i.toDate)==null?void 0:d.call(i))==null?void 0:l.toISOString())||new Date().toISOString()}});t(s)},a=>{console.error("Waitlist subscription error:",a)})}catch(e){return console.error("Error setting up waitlist subscription:",e),()=>{}}}async function X(t){var e,r,a;try{const s=t.toLowerCase().trim(),o=S(h(n,"waitlist"),H("email","==",s)),i=await I(o);return i.empty?{status:"success",message:"Successfully joined the waitlist!",data:{id:(await j(h(n,"waitlist"),{email:s,joined_at:g(),ip:window.sessionStorage.getItem("userIP")||"unknown",userAgent:navigator.userAgent})).id,email:s,joined_at:new Date().toISOString()}}:{status:"already_exists",message:"You are already on the waitlist! We'll notify you of any updates.",data:{id:i.docs[0].id,email:s,joined_at:((a=(r=(e=i.docs[0].data().joined_at)==null?void 0:e.toDate)==null?void 0:r.call(e))==null?void 0:a.toISOString())||new Date().toISOString()}}}catch(s){throw console.error("Error adding to waitlist:",s),s}}async function Z(t){try{const e=await m(u(n,"admin_sessions","current"));if(!e.exists()||!e.data().authenticated)throw new Error("Unauthorized");const r=u(n,"waitlist",t);if(!(await m(r)).exists())throw new Error("User not found");return await E(r),!0}catch(e){throw console.error("Error deleting waitlist user:",e),e}}async function $(t){try{const e=await m(u(n,"admin_sessions","current"));if(!e.exists()||!e.data().authenticated)throw new Error("Unauthorized");return(await j(h(n,"updates"),{title:t.title,content:t.content,image_url:t.image_url||"",created_at:g(),comments:[],author:"admin"})).id}catch(e){throw console.error("Error adding update:",e),e}}async function tt(t,e){try{const r=await m(u(n,"admin_sessions","current"));if(!r.exists()||!r.data().authenticated)throw new Error("Unauthorized");const a=u(n,"updates",t);return await f(a,{title:e.title,content:e.content,image_url:e.image_url||"",updated_at:g()}),!0}catch(r){throw console.error("Error updating update:",r),r}}async function et(t){try{const e=await m(u(n,"admin_sessions","current"));if(!e.exists()||!e.data().authenticated)throw new Error("Unauthorized");return await E(u(n,"updates",t)),!0}catch(e){throw console.error("Error deleting update:",e),e}}function rt(t){try{const e=S(h(n,"updates"),k("created_at","desc"));return v(e,r=>{const a=r.docs.map(s=>{var i,d,l;const o=s.data();return{id:s.id,title:o.title||"",content:o.content||"",image_url:o.image_url||"",created_at:((l=(d=(i=o.created_at)==null?void 0:i.toDate)==null?void 0:d.call(i))==null?void 0:l.toISOString())||new Date().toISOString(),comments:o.comments||[],author:o.author||"admin"}});t(a)})}catch(e){return console.error("Error setting up updates subscription:",e),()=>{}}}async function at(t,e){try{const r=await m(u(n,"admin_sessions","current"));if(!r.exists()||!r.data().authenticated)throw new Error("Unauthorized");const a=u(n,"waitlist",t),s=await m(a);if(!s.exists())throw new Error("User not found");return await f(a,{feedback:e,feedback_at:g(),updated_by:r.data().timestamp}),{id:t,...s.data(),feedback:e,feedback_at:new Date().toISOString()}}catch(r){throw console.error("Error updating user feedback:",r),r}}async function st(t,e){try{const r=u(n,"updates",t),a=await m(r);if(!a.exists())throw new Error("Update not found");const s={id:Date.now().toString(),update_id:t,user_email:e.user_email,content:e.content,created_at:new Date().toISOString(),admin_reply:null,admin_reply_at:null},o=a.data().comments||[];return await f(r,{comments:[...o,s]}),s}catch(r){throw console.error("Error adding comment:",r),r}}async function ot(t,e,r){try{const a=await m(u(n,"admin_sessions","current"));if(!a.exists()||!a.data().authenticated)throw new Error("Unauthorized");const s=u(n,"updates",t),o=await m(s);if(!o.exists())throw new Error("Update not found");const d=(o.data().comments||[]).map(l=>l.id===e?{...l,admin_reply:r,admin_reply_at:new Date().toISOString()}:l);return await f(s,{comments:d}),!0}catch(a){throw console.error("Error adding admin reply:",a),a}}async function it(t,e){try{const r=await m(u(n,"admin_sessions","current"));if(!r.exists()||!r.data().authenticated)throw new Error("Unauthorized");const a=u(n,"updates",t),s=await m(a);if(!s.exists())throw new Error("Update not found");const i=(s.data().comments||[]).filter(d=>d.id!==e);return await f(a,{comments:i,lastModified:new Date().toISOString()}),!0}catch(r){throw console.error("Error deleting comment:",r),r}}class p{constructor(e=0,r="Network Error"){this.status=e,this.text=r}}const q=()=>{if(!(typeof localStorage>"u"))return{get:t=>Promise.resolve(localStorage.getItem(t)),set:(t,e)=>Promise.resolve(localStorage.setItem(t,e)),remove:t=>Promise.resolve(localStorage.removeItem(t))}},c={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:q()},_=t=>t?typeof t=="string"?{publicKey:t}:t.toString()==="[object Object]"?t:{}:{},F=(t,e="https://api.emailjs.com")=>{if(!t)return;const r=_(t);c.publicKey=r.publicKey,c.blockHeadless=r.blockHeadless,c.storageProvider=r.storageProvider,c.blockList=r.blockList,c.limitRate=r.limitRate,c.origin=r.origin||e},R=async(t,e,r={})=>{const a=await fetch(c.origin+t,{method:"POST",headers:r,body:e}),s=await a.text(),o=new p(a.status,s);if(a.ok)return o;throw o},D=(t,e,r)=>{if(!t||typeof t!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!e||typeof e!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!r||typeof r!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},V=t=>{if(t&&t.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},P=t=>t.webdriver||!t.languages||t.languages.length===0,T=()=>new p(451,"Unavailable For Headless Browser"),z=(t,e)=>{if(!Array.isArray(t))throw"The BlockList list has to be an array";if(typeof e!="string")throw"The BlockList watchVariable has to be a string"},C=t=>{var e;return!((e=t.list)!=null&&e.length)||!t.watchVariable},K=(t,e)=>t instanceof FormData?t.get(e):t[e],L=(t,e)=>{if(C(t))return!1;z(t.list,t.watchVariable);const r=K(e,t.watchVariable);return typeof r!="string"?!1:t.list.includes(r)},U=()=>new p(403,"Forbidden"),B=(t,e)=>{if(typeof t!="number"||t<0)throw"The LimitRate throttle has to be a positive number";if(e&&typeof e!="string")throw"The LimitRate ID has to be a non-empty string"},W=async(t,e,r)=>{const a=Number(await r.get(t)||0);return e-Date.now()+a},x=async(t,e,r)=>{if(!e.throttle||!r)return!1;B(e.throttle,e.id);const a=e.id||t;return await W(a,e.throttle,r)>0?!0:(await r.set(a,Date.now().toString()),!1)},O=()=>new p(429,"Too Many Requests"),A=async(t,e,r,a)=>{const s=_(a),o=s.publicKey||c.publicKey,i=s.blockHeadless||c.blockHeadless,d=s.storageProvider||c.storageProvider,l={...c.blockList,...s.blockList},b={...c.limitRate,...s.limitRate};return i&&P(navigator)?Promise.reject(T()):(D(o,t,e),V(r),r&&L(l,r)?Promise.reject(U()):await x(location.pathname,b,d)?Promise.reject(O()):R("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:o,service_id:t,template_id:e,template_params:r}),{"Content-type":"application/json"}))},M=t=>{if(!t||t.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},N=t=>typeof t=="string"?document.querySelector(t):t,J=async(t,e,r,a)=>{const s=_(a),o=s.publicKey||c.publicKey,i=s.blockHeadless||c.blockHeadless,d=c.storageProvider||s.storageProvider,l={...c.blockList,...s.blockList},b={...c.limitRate,...s.limitRate};if(i&&P(navigator))return Promise.reject(T());const y=N(r);D(o,t,e),M(y);const w=new FormData(y);return L(l,w)?Promise.reject(U()):await x(location.pathname,b,d)?Promise.reject(O()):(w.append("lib_version","4.4.1"),w.append("service_id",t),w.append("template_id",e),w.append("user_id",o),R("/api/v1.0/email/send-form",w))},nt={init:F,send:A,sendForm:J,EmailJSResponseStatus:p};export{st as a,X as b,G as c,$ as d,nt as e,et as f,Z as g,at as h,it as i,ot as j,rt as s,tt as u};
//# sourceMappingURL=index-ff4cc8bf.js.map
